import Head from 'next/head'
import Layout from '../components/layout'
import React, { useMemo } from 'react'
import Banner from "../components/banner";
import About from "../components/about";
import Portfolio from "../components/portfolio";
import Testimonial from "../components/testimonial";
import Log from "../components/log"
import { useUserContext } from '../context/userContext'
import { getUserFromCookie } from '../components/auth/userCookies'

const Home: React.FC = () => {
  const { user, setUser } = useUserContext();
  
  useMemo(() => {
    if (!user) {
      setUser(getUserFromCookie());
    }
  }, [user])

  return (
    <div>
      <Head>
        {user && user.short_name ? (
          <title>Portfolio Of {user.short_name}</title>
        ) : (
          <title>Portfolio Of Someone</title>
        )}
        <meta name="description" content="Generated by create next app" />
        <link rel="icon" href="/favicon.ico" />
      </Head>
      <Layout>
        {user && user.short_name ? (
          <>
            <Banner short_name={user.short_name} profession={user.profession} />
            <About full_name={user.full_name} profession={user.profession} avatar_url={user.avatar_url} />
            <Log doc_id={user.docId} />
          </>
        ) : (
          <>
            <Banner />
            <About />
            <Log />
          </>
        )
        }
        <Portfolio />
        <Testimonial />
      </Layout>
    </div>
  )
}
export default Home